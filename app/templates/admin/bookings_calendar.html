{% extends "admin/base_admin.html" %}

{% block page_title %}áƒ¯áƒáƒ•áƒ¨áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ™áƒáƒšáƒ”áƒœáƒ“áƒáƒ áƒ˜{% endblock %}

{% block extra_css %}
<link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css' rel='stylesheet' />

<style>
    /* ğŸ¨ OPTION 4: PROFESSIONAL MODERN
     * =====================================
     * âœ… Dark theme (áƒœáƒáƒ™áƒšáƒ”áƒ‘áƒ˜ áƒ“áƒáƒ¦áƒšáƒ˜áƒšáƒáƒ‘áƒ)
     * âœ… Subtle glassmorphism (áƒáƒ áƒ aggressive)
     * âœ… Functional first, beauty second
     * âœ… Brand colors (Mad Men identity)
     * âœ… Fast performance
     */
    
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

    :root {
        /* ğŸ¨ Brand Colors - Mad Men Theme */
        --brand-primary: #B07D4A;      /* Gold - áƒ«áƒ˜áƒ áƒ˜áƒ—áƒáƒ“áƒ˜ */
        --brand-secondary: #8B4513;    /* Brown */
        --brand-accent: #D4915C;       /* Light Gold */
        
        /* ğŸŒ“ Background System */
        --bg-main: #0d1117;            /* GitHub Dark */
        --bg-elevated: #161b22;        /* Cards */
        --bg-hover: #1f2937;           /* Hover states */
        
        /* ğŸ¯ Functional Colors */
        --success: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
        --info: #3b82f6;
        
        /* ğŸ“ Text */
        --text-primary: #e6edf3;
        --text-secondary: #8b949e;
        --text-muted: #6e7681;
        
        /* ğŸ”² Borders & Shadows */
        --border: #30363d;
        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
        --shadow-lg: 0 10px 30px rgba(0, 0, 0, 0.5);
    }

    * {
        font-family: 'Inter', -apple-system, system-ui, sans-serif;
    }

    body {
        background: var(--bg-main);
        color: var(--text-primary);
    }

    /* ğŸ“¦ MAIN LAYOUT */
    .page-wrapper {
        max-width: 1800px;
        margin: 0 auto;
        padding: 24px;
    }

    /* ğŸ¯ TOP CONTROL BAR - Compact & Functional */
    .control-bar {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 16px 20px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        box-shadow: var(--shadow-sm);
    }

    /* ğŸ“… Title - Clean & Professional */
    .calendar-title {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 18px;
        font-weight: 700;
        color: var(--text-primary);
    }

    .calendar-icon {
        width: 32px;
        height: 32px;
        background: linear-gradient(135deg, var(--brand-primary), var(--brand-accent));
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
    }

    /* ğŸ›ï¸ CONTROLS - Right Side */
    .calendar-actions {
        display: flex;
        gap: 12px;
        align-items: center;
    }

    /* ğŸ‘¥ Barber Filter - Subtle */
    .filter-wrapper {
        position: relative;
    }

    .barber-filter {
        background: var(--bg-main);
        border: 1px solid var(--border);
        color: var(--text-primary);
        padding: 10px 16px;
        padding-left: 38px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s;
        min-width: 220px;
        appearance: none;
    }

    .barber-filter:hover {
        border-color: var(--brand-primary);
        background: var(--bg-hover);
    }

    .barber-filter:focus {
        outline: none;
        border-color: var(--brand-primary);
        box-shadow: 0 0 0 3px rgba(176, 125, 74, 0.1);
    }

    .filter-icon {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-secondary);
        font-size: 16px;
        pointer-events: none;
    }

    /* â• Create Button - Brand Accent */
    .btn-create {
        background: linear-gradient(135deg, var(--brand-primary), var(--brand-accent));
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        font-weight: 700;
        font-size: 14px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.2s;
        box-shadow: 0 2px 8px rgba(176, 125, 74, 0.3);
    }

    .btn-create:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(176, 125, 74, 0.4);
    }

    .btn-create:active {
        transform: translateY(0);
    }

    /* ğŸ“… CALENDAR CONTAINER */
    .calendar-container {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 20px;
        box-shadow: var(--shadow-md);
        min-height: calc(100vh - 180px);
    }

    /* âœ… FULLCALENDAR CUSTOMIZATION */
    .fc {
        --fc-border-color: var(--border);
        --fc-page-bg-color: transparent;
        --fc-neutral-bg-color: rgba(255, 255, 255, 0.02);
        --fc-today-bg-color: rgba(176, 125, 74, 0.08);
    }

    /* ğŸ¯ Toolbar */
    .fc .fc-toolbar {
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 1px solid var(--border);
    }

    .fc .fc-toolbar-title {
        color: var(--text-primary);
        font-size: 20px;
        font-weight: 700;
        letter-spacing: -0.3px;
    }

    /* ğŸ”˜ Buttons - Subtle & Functional */
    .fc .fc-button-primary {
        background: var(--bg-main);
        border: 1px solid var(--border);
        color: var(--text-secondary);
        text-transform: capitalize;
        font-weight: 600;
        padding: 8px 14px;
        border-radius: 6px;
        transition: all 0.2s;
        font-size: 13px;
    }

    .fc .fc-button-primary:hover {
        background: var(--bg-hover);
        border-color: var(--brand-primary);
        color: var(--text-primary);
    }

    .fc .fc-button-primary:not(:disabled).fc-button-active {
        background: var(--brand-primary);
        border-color: var(--brand-primary);
        color: white;
    }

    .fc .fc-button-primary:focus {
        box-shadow: 0 0 0 2px rgba(176, 125, 74, 0.2);
    }

    /* ğŸ“… Headers */
    .fc .fc-col-header {
        background: var(--bg-main);
    }

    .fc .fc-col-header-cell {
        border-color: var(--border);
        padding: 12px 4px;
    }

    .fc .fc-col-header-cell-cushion {
        color: var(--text-secondary);
        font-weight: 700;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    /* ğŸ• Time Labels */
    .fc .fc-timegrid-slot-label-cushion {
        color: var(--text-muted);
        font-size: 11px;
        font-weight: 600;
    }

    .fc .fc-timegrid-slot {
        border-color: var(--border);
    }

    /* ğŸ¯ EVENTS - Clean & Readable */
    .fc-event {
        border: none !important;
        border-left: 3px solid !important;
        border-radius: 4px !important;
        padding: 4px 8px !important;
        font-weight: 600 !important;
        backdrop-filter: blur(10px);
        transition: all 0.15s ease !important;
        cursor: pointer !important;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
    }

    .fc-event:hover {
        transform: translateY(-1px) !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
        filter: brightness(1.1);
    }

    .fc-event-time {
        font-size: 11px;
        font-weight: 700;
        opacity: 0.95;
    }

    .fc-event-title {
        font-size: 12px;
        font-weight: 600;
        margin-top: 2px;
    }

    /* ğŸ”¥ Current Time Indicator */
    .fc .fc-timegrid-now-indicator-line {
        border-color: var(--danger);
        border-width: 2px;
    }

    .fc .fc-timegrid-now-indicator-arrow {
        border-color: var(--danger);
        border-width: 6px;
    }

    /* âœ‚ï¸ RESOURCE SIDEBAR - Clean & Organized */
    .fc-datagrid-cell {
        background: var(--bg-main) !important;
        border-color: var(--border) !important;
    }

    .fc-datagrid-cell-cushion {
        color: var(--text-primary) !important;
        font-weight: 600;
        padding: 14px 12px;
        font-size: 13px;
    }

    .fc-resource-timeline-divider {
        background: var(--bg-main) !important;
        border-right: 2px solid var(--brand-primary) !important;
    }

    /* ğŸ¯ Resource Header */
    .fc-datagrid-header .fc-datagrid-cell-cushion {
        color: var(--brand-primary) !important;
        font-weight: 700;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.8px;
    }

    /* ğŸ“± MOBILE RESPONSIVE */
    @media (max-width: 768px) {
        .page-wrapper {
            padding: 12px;
        }

        .control-bar {
            flex-direction: column;
            align-items: stretch;
            padding: 12px 16px;
        }

        .calendar-actions {
            flex-direction: column;
            width: 100%;
        }

        .barber-filter,
        .btn-create {
            width: 100%;
            justify-content: center;
        }

        .calendar-container {
            padding: 12px;
        }

        .fc .fc-toolbar {
            flex-direction: column;
            gap: 12px;
        }

        .fc .fc-toolbar-chunk {
            display: flex;
            justify-content: center;
            gap: 6px;
        }

        .fc .fc-toolbar-title {
            font-size: 18px;
        }
    }

    /* ğŸ¨ BARBER COLORS - Distinct & Professional */
    .barber-1 { 
        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%) !important; 
        border-left-color: #1e40af !important;
    }
    .barber-2 { 
        background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%) !important;
        border-left-color: #6d28d9 !important;
    }
    .barber-3 { 
        background: linear-gradient(135deg, #ec4899 0%, #db2777 100%) !important;
        border-left-color: #be185d !important;
    }
    .barber-4 { 
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
        border-left-color: #b45309 !important;
    }
    .barber-5 { 
        background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;
        border-left-color: #047857 !important;
    }
    .barber-6 { 
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%) !important;
        border-left-color: #b91c1c !important;
    }

    /* ğŸ­ LOADING STATE */
    .fc-loading {
        opacity: 0.6;
        pointer-events: none;
    }

    /* âš¡ PERFORMANCE OPTIMIZATIONS */
    * {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    .fc-event {
        will-change: transform;
    }

    /* ğŸ¯ ACCESSIBILITY */
    .fc-button:focus-visible {
        outline: 2px solid var(--brand-primary);
        outline-offset: 2px;
    }

    .barber-filter:focus-visible {
        outline: 2px solid var(--brand-primary);
        outline-offset: 2px;
    }
</style>

<script src='https://cdn.jsdelivr.net/npm/fullcalendar-scheduler@6.1.10/index.global.min.js'></script>
<script src="{{ url_for('static', filename='js/admin-calendar.js') }}"></script>
{% endblock %}

{% block content %}
<div class="page-wrapper">
    <!-- ğŸ¯ Control Bar - Simple & Functional -->
    <div class="control-bar">
        <div class="calendar-title">
            <div class="calendar-icon">ğŸ“…</div>
            <span>áƒ¯áƒáƒ•áƒ¨áƒœáƒ”áƒ‘áƒ˜áƒ¡ áƒ™áƒáƒšáƒ”áƒœáƒ“áƒáƒ áƒ˜</span>
        </div>

        <div class="calendar-actions">
            <!-- ğŸ‘¥ Barber Filter -->
            <div class="filter-wrapper">
                <span class="filter-icon">ğŸ‘¤</span>
                <select id="barberFilter" class="barber-filter">
                    <option value="all">áƒ§áƒ•áƒ”áƒšáƒ áƒ‘áƒáƒ áƒ‘áƒ”áƒ áƒ˜</option>
                    {% for barber in barbers %}
                    <option value="{{ barber.id }}">{{ barber.get_full_name() }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- â• Create Button -->
            <button onclick="showCreateBookingModal(new Date().toISOString())" class="btn-create">
                <span>â•</span>
                <span>áƒáƒ®áƒáƒšáƒ˜ áƒ¯áƒáƒ•áƒ¨áƒáƒœáƒ˜</span>
            </button>
        </div>
    </div>

    <!-- ğŸ“… Calendar -->
    <div class="calendar-container">
        <div id="booking-calendar"></div>
    </div>
</div>

<!-- ğŸ­ Event Details Modal -->
<div id="eventDetailsModal" class="modal-overlay hidden">
    <div id="detailsModalBody"></div>
</div>
{% endblock %}